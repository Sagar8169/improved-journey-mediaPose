exports.id=265,exports.ids=[265],exports.modules={862:(e,t,s)=>{"use strict";s.a(e,async(e,r)=>{try{s.d(t,{A:()=>m});var i=s(997),n=s(1664),a=s.n(n),o=s(6689),c=s(1193),l=e([c]);function m({children:e}){let[t,s]=(0,o.useState)(!1),{currentUser:r,logout:n}=(0,c.t)();return(0,i.jsxs)("div",{className:"min-h-[100svh] flex flex-col bg-bg text-brandText",children:[(0,i.jsxs)("header",{className:"sticky top-0 z-40 border-b border-panel bg-bg/95 backdrop-blur supports-[backdrop-filter]:bg-bg/80 safe-top",children:[i.jsx("div",{className:"max-w-7xl mx-auto px-4",children:(0,i.jsxs)("div",{className:"flex items-center justify-between h-14",children:[(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-8 h-8 rounded-md bg-accent/10 flex items-center justify-center border border-accent/30 text-accent font-bold text-xs",children:"JJ"}),i.jsx(a(),{href:r?"/home":"/",className:"font-semibold tracking-wide text-sm sm:text-base text-accent hover:opacity-90",children:"JIU-JITSU TRAINING"})]}),(0,i.jsxs)("nav",{className:"hidden md:flex items-center gap-8 text-sm",children:[r&&i.jsx(a(),{href:"/home",className:"hover:text-accent/80",children:"Home"}),r&&i.jsx(a(),{href:"/drill",className:"hover:text-accent/80",children:"Drill"}),r&&i.jsx(a(),{href:"/profile",className:"hover:text-accent/80",children:"Profile"}),r&&i.jsx("button",{onClick:n,className:"text-xs px-3 py-1 rounded bg-panel border border-accent/30 hover:bg-accent/10 text-accent",children:"Logout"})]}),i.jsx("button",{"aria-label":"Menu",onClick:()=>s(e=>!e),className:"md:hidden inline-flex items-center justify-center w-9 h-9 rounded bg-panel border border-panel hover:border-accent/40 text-accent",children:"â˜°"})]})}),t&&(0,i.jsxs)("div",{className:"md:hidden border-t border-panel bg-bg px-4 pb-4 pt-2 space-y-2 text-sm",children:[r&&i.jsx(a(),{onClick:()=>s(!1),href:"/home",className:"block py-1 hover:text-accent/80",children:"Home"}),r&&i.jsx(a(),{onClick:()=>s(!1),href:"/drill",className:"block py-1 hover:text-accent/80",children:"Drill"}),r&&i.jsx(a(),{onClick:()=>s(!1),href:"/profile",className:"block py-1 hover:text-accent/80",children:"Profile"}),r&&i.jsx("button",{onClick:()=>{n(),s(!1)},className:"block py-1 text-accent hover:opacity-80",children:"Logout"})]})]}),i.jsx("main",{className:"flex-1",children:e}),i.jsx("footer",{className:"py-6 text-center text-xs text-neutral-500 border-t border-panel safe-bottom",children:"Local-first prototype."})]})}c=(l.then?(await l)():l)[0],r()}catch(e){r(e)}})},1695:(e,t,s)=>{"use strict";s.a(e,async(e,r)=>{try{s.d(t,{Y:()=>l});var i=s(997),n=s(1163),a=s(6689),o=s(1193),c=e([o]);o=(c.then?(await c)():c)[0];let l=({children:e})=>{let t=(0,o.t)(e=>e.currentUser),s=(0,n.useRouter)();return((0,a.useEffect)(()=>{t||s.replace("/")},[t,s]),t)?i.jsx(i.Fragment,{children:e}):null};r()}catch(e){r(e)}})},1193:(e,t,s)=>{"use strict";s.a(e,async(e,r)=>{try{s.d(t,{t:()=>c});var i=s(6912),n=e([i]);i=(n.then?(await n)():n)[0];let o=e=>e.includes("@");function a(){return"undefined"!=typeof crypto&&"randomUUID"in crypto?crypto.randomUUID():Math.random().toString(36).slice(2)+Date.now().toString(36)}let c=(0,i.create)((e,t)=>({users:[{name:"Demo User",email:"demo@jiujitsu.com",password:"demo123"}],currentUser:null,sessionToken:null,lastAuthAt:null,signup:({name:s,email:r,password:i})=>{if(s=s.trim(),r=r.trim().toLowerCase(),!s)return{ok:!1,error:"Name required"};if(!r)return{ok:!1,error:"Email required"};if(!o(r))return{ok:!1,error:"Invalid email"};if(i.length<6)return{ok:!1,error:"Password too short"};let{users:n}=t();if(n.some(e=>e.email===r))return{ok:!1,error:"Email already registered"};let c={name:s,email:r,password:i},l=a();return e({users:[...n,c],currentUser:c,sessionToken:l,lastAuthAt:Date.now()}),{ok:!0}},login:(s,r)=>{s=s.trim().toLowerCase();let{users:i}=t(),n=i.find(e=>e.email===s);if(!n)return{ok:!1,error:"Email not found"};if(n.password!==r)return{ok:!1,error:"Incorrect password"};let o=a();return e({currentUser:n,sessionToken:o,lastAuthAt:Date.now()}),{ok:!0}},logout:()=>e({currentUser:null,sessionToken:null}),updateProfile:s=>{let{currentUser:r,users:i}=t();if(!r)return{ok:!1,error:"Not authenticated"};let n=s.email?.trim().toLowerCase();if(void 0!==s.name&&!s.name.trim())return{ok:!1,error:"Name required"};if(void 0!==n){if(!n)return{ok:!1,error:"Email required"};if(!o(n))return{ok:!1,error:"Invalid email"};if(i.some(e=>e.email===n&&e.email!==r.email))return{ok:!1,error:"Email already taken"}}if(void 0!==s.password&&s.password.length<6)return{ok:!1,error:"Password too short"};let a={...r,...s,email:void 0!==n?n:r.email};return e({currentUser:a,users:i.map(e=>e.email===r.email?a:e)}),{ok:!0}},hydrateSession:(s,r)=>{let{users:i}=t(),n=i.find(e=>e.email===s);return!!n&&(e({currentUser:n,sessionToken:r}),!0)}}));r()}catch(e){r(e)}})},7865:(e,t,s)=>{"use strict";s.a(e,async(e,r)=>{try{s.d(t,{H:()=>c});var i=s(6912),n=s(1230),a=e([i]);i=(a.then?(await a)():a)[0];let o={totalReps:0,sessions:0,bestSymShoulder:null,bestSymKnee:null,postureIssues:0,lastUpdated:null,startedAt:null},c=(0,i.create)((e,t)=>({...o,activeSessionStart:null,sessionRecords:[],activeSessionTracker:null,sessionHistory:[],addSession:t=>e(e=>({...e,sessions:e.sessions+1,startedAt:Date.now(),...t,lastUpdated:Date.now()})),addReps:t=>e(e=>({totalReps:e.totalReps+t,lastUpdated:Date.now()})),addRep:()=>e(e=>({totalReps:e.totalReps+1,lastUpdated:Date.now()})),considerSymmetry:(t,s)=>e(e=>({bestSymShoulder:null!=t?null==e.bestSymShoulder?t:Math.min(e.bestSymShoulder,t):e.bestSymShoulder,bestSymKnee:null!=s?null==e.bestSymKnee?s:Math.min(e.bestSymKnee,s):e.bestSymKnee,lastUpdated:Date.now()})),recordPostureIssue:()=>e(e=>({postureIssues:e.postureIssues+1,lastUpdated:Date.now()})),resetAll:()=>e({...o,activeSessionStart:null,sessionRecords:[]}),startSession:()=>e(e=>e.activeSessionStart?e:{activeSessionStart:Date.now(),startedAt:Date.now()}),finalizeSession:({reps:t,postureIssuesDelta:s})=>{let r=null;return e(e=>{if(!e.activeSessionStart)return e;let i=Date.now();return r={id:crypto.randomUUID?.()||Math.random().toString(36).slice(2),startedAt:e.activeSessionStart,endedAt:i,durationSec:(i-e.activeSessionStart)/1e3,reps:t,postureIssues:s,bestSymShoulder:e.bestSymShoulder,bestSymKnee:e.bestSymKnee},{...e,activeSessionStart:null,sessionRecords:[r,...e.sessionRecords].slice(0,100),sessions:e.sessions+1,lastUpdated:Date.now()}}),r},startSessionTracking:(s,r,i)=>{if(t().activeSessionTracker)return;let a=new n.O(s,r,i);e({activeSessionTracker:a})},updateFrameMetrics:e=>{let s=t().activeSessionTracker;s&&s.updateFrame(e)},endSessionTracking:()=>{let s=t().activeSessionTracker;if(!s)return null;let r=s.finalize();return e(e=>({activeSessionTracker:null,sessionHistory:[r,...e.sessionHistory].slice(0,100)})),r},clearSessionHistory:()=>e({sessionHistory:[]})}));r()}catch(e){r(e)}})},1230:(e,t,s)=>{"use strict";function r(e,t){let s=e.count+1,r=t-e.mean,i=e.mean+r/s,n=e.m2+r*(t-i);return{mean:i,m2:n,count:s}}s.d(t,{O:()=>i});class i{constructor(e,t,s){this.rec={schemaVersion:1,sessionId:crypto.randomUUID(),userId:e,startTs:Date.now(),frameCount:0,modelComplexity:t,mirrorUsed:s,detectionFrames:0,avgVisibilitySum:0,bboxAreaSumPct:0,bboxAreaSumSqPct:0,postureIssues:0,torsoAngleSum:0,torsoAngleSumSq:0,shoulderSym:{min:1/0,max:-1/0,mean:0,m2:0,count:0},kneeSym:{min:1/0,max:-1/0,mean:0,m2:0,count:0},jointStats:{},repsByMode:{},totalReps:0,maxRepStreak:0,currentStreak:0,interruptions:0,errors:[],segments:[],segActive:null,fpsSum:0,fpsSumSq:0}}startSegment(e){this.rec.segActive={tStart:e,tEnd:e,reps:0,postureIssues:0}}rollSegment(e){if(!this.rec.segActive){this.startSegment(e);return}let t=this.rec.segActive;t.tEnd=e,t.tEnd-t.tStart>=3e4&&(this.rec.segments.push(t),this.startSegment(e))}updateFrame(e){let t=Date.now();if(this.rollSegment(t),this.rec.frameCount++,null!=e.fps&&(this.rec.fpsSum+=e.fps,this.rec.fpsSumSq+=e.fps*e.fps),e.hasPose){if(this.rec.detectionFrames++,null!=e.visibilityAvg&&(this.rec.avgVisibilitySum+=e.visibilityAvg),null!=e.bboxAreaPct&&(this.rec.bboxAreaSumPct+=e.bboxAreaPct,this.rec.bboxAreaSumSqPct+=e.bboxAreaPct*e.bboxAreaPct),null!=e.torsoAngle&&(this.rec.torsoAngleSum+=e.torsoAngle,this.rec.torsoAngleSumSq+=e.torsoAngle*e.torsoAngle),null!=e.shoulderSym&&this.updateSym("shoulderSym",e.shoulderSym),null!=e.kneeSym&&this.updateSym("kneeSym",e.kneeSym),e.jointAngles)for(let[t,s]of Object.entries(e.jointAngles)){if(null==s)continue;let e=this.rec.jointStats[t];if(e){e.min=Math.min(e.min,s),e.max=Math.max(e.max,s);let t=r(e,s);e.mean=t.mean,e.m2=t.m2,e.count=t.count}else e={min:s,max:s,mean:s,m2:0,count:1},this.rec.jointStats[t]=e}e.postureIssue&&(this.rec.postureIssues++,this.rec.segActive&&this.rec.segActive.postureIssues++),e.repIncrement&&e.repMode&&(this.rec.repsByMode[e.repMode]=(this.rec.repsByMode[e.repMode]||0)+1,this.rec.totalReps++,this.rec.firstRepTs||(this.rec.firstRepTs=t),this.rec.currentStreak++,this.rec.maxRepStreak=Math.max(this.rec.maxRepStreak,this.rec.currentStreak),this.rec.segActive&&this.rec.segActive.reps++)}}updateSym(e,t){let s=this.rec[e];s.min=Math.min(s.min,t),s.max=Math.max(s.max,t);let i=r(s,t);s.mean=i.mean,s.m2=i.m2,s.count=i.count}interrupt(){this.rec.interruptions++,this.rec.currentStreak=0}finalize(){let e=Date.now();this.rec.endTs=e,this.rec.durationSec=(e-this.rec.startTs)/1e3,this.rec.segActive&&(this.rec.segActive.tEnd=e,this.rec.segActive.tEnd-this.rec.segActive.tStart>1e3&&this.rec.segments.push(this.rec.segActive));let t=this.rec.detectionFrames/Math.max(1,this.rec.frameCount);this.rec.detectionRate=t,this.rec.avgVisibility=this.rec.detectionFrames?this.rec.avgVisibilitySum/this.rec.detectionFrames:0,this.rec.formConsistencyScore=this.estimateFormScore(),this.rec.focusScore=100*(this.rec.detectionRate||0);let s={};return 10>(this.rec.durationSec||0)&&(s.short=!0),t<.4&&(s.lowQuality=!0),this.rec.qualityFlags=s,this.rec.finalized=!0,this.rec}estimateFormScore(){let e=this.rec.shoulderSym,t=this.rec.kneeSym,s=e.count>1?e.m2/(e.count-1):0,r=t.count>1?t.m2/(t.count-1):0,i=Math.min(1,this.rec.postureIssues/Math.max(10,this.rec.durationSec||1));return Math.round(100*(.4*(1-Math.min(1,(s+r)/400))+.3*(this.rec.detectionRate||0)+.3*(1-i)))}}},6814:(e,t,s)=>{"use strict";s.a(e,async(e,r)=>{try{s.r(t),s.d(t,{default:()=>u});var i=s(997);s(6764);var n=s(968),a=s.n(n),o=s(6689),c=s(1163),l=s(1193),m=e([l]);function u({Component:e,pageProps:t}){(0,c.useRouter)();let{currentUser:s,hydrateSession:r,sessionToken:n,lastAuthAt:m}=(0,l.t)(),[u,d]=(0,o.useState)(!1);return u?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(a(),{children:[i.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1, viewport-fit=cover"}),i.jsx("meta",{name:"theme-color",content:"#0D1117"})]}),i.jsx(e,{...t})]}):i.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh",color:"#888",fontFamily:"sans-serif",background:"#000"},children:"Loadingâ€¦"})}l=(m.then?(await m)():m)[0],r()}catch(e){r(e)}})},6764:()=>{}};