(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[888],{6840:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return r(9645)}])},4486:function(e,t,r){"use strict";r.d(t,{t:function(){return u}});var n=r(4529);let o=e=>e.includes("@");function i(){return"undefined"!=typeof crypto&&"randomUUID"in crypto?crypto.randomUUID():Math.random().toString(36).slice(2)+Date.now().toString(36)}let u=(0,n.Ue)((e,t)=>({users:[{name:"Demo User",email:"demo@jiujitsu.com",password:"demo123"}],currentUser:null,sessionToken:null,lastAuthAt:null,signup:r=>{let{name:n,email:u,password:a}=r;if(n=n.trim(),u=u.trim().toLowerCase(),!n)return{ok:!1,error:"Name required"};if(!u)return{ok:!1,error:"Email required"};if(!o(u))return{ok:!1,error:"Invalid email"};if(a.length<6)return{ok:!1,error:"Password too short"};let{users:s}=t();if(s.some(e=>e.email===u))return{ok:!1,error:"Email already registered"};let l={name:n,email:u,password:a};return e({users:[...s,l],currentUser:l,sessionToken:i(),lastAuthAt:Date.now()}),{ok:!0}},login:(r,n)=>{r=r.trim().toLowerCase();let{users:o}=t(),u=o.find(e=>e.email===r);return u?u.password!==n?{ok:!1,error:"Incorrect password"}:(e({currentUser:u,sessionToken:i(),lastAuthAt:Date.now()}),{ok:!0}):{ok:!1,error:"Email not found"}},logout:()=>e({currentUser:null,sessionToken:null}),updateProfile:r=>{var n;let{currentUser:i,users:u}=t();if(!i)return{ok:!1,error:"Not authenticated"};let a=null===(n=r.email)||void 0===n?void 0:n.trim().toLowerCase();if(void 0!==r.name&&!r.name.trim())return{ok:!1,error:"Name required"};if(void 0!==a){if(!a)return{ok:!1,error:"Email required"};if(!o(a))return{ok:!1,error:"Invalid email"};if(u.some(e=>e.email===a&&e.email!==i.email))return{ok:!1,error:"Email already taken"}}if(void 0!==r.password&&r.password.length<6)return{ok:!1,error:"Password too short"};let s={...i,...r,email:void 0!==a?a:i.email};return e({currentUser:s,users:u.map(e=>e.email===i.email?s:e)}),{ok:!0}},hydrateSession:(r,n)=>{let{users:o}=t(),i=o.find(e=>e.email===r);return!!i&&(e({currentUser:i,sessionToken:n}),!0)}}))},9645:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l}});var n=r(5893);r(3434);var o=r(9008),i=r.n(o),u=r(7294),a=r(1163),s=r(4486);function l(e){let{Component:t,pageProps:r}=e,o=(0,a.useRouter)(),{currentUser:l,hydrateSession:c,sessionToken:f,lastAuthAt:d}=(0,s.t)(),[m,v]=(0,u.useState)(!1),p="jj_app.auth",h="jj_app.lastRoute",g=new Set(["/home","/drill","/profile"]);return((0,u.useEffect)(()=>{if(!l){let e=localStorage.getItem(p);if(e)try{let t=JSON.parse(e);(null==t?void 0:t.email)&&(null==t?void 0:t.token)&&!c(t.email,t.token)&&localStorage.removeItem(p)}catch(e){localStorage.removeItem(p)}}v(!0)},[l,c]),(0,u.useEffect)(()=>{let e=e=>{localStorage.setItem(h,e)};return o.events.on("routeChangeComplete",e),()=>{o.events.off("routeChangeComplete",e)}},[o.events]),(0,u.useEffect)(()=>{l&&f?localStorage.setItem(p,JSON.stringify({email:l.email,token:f})):(localStorage.removeItem(p),localStorage.removeItem(h))},[l,f]),(0,u.useEffect)(()=>{if(m&&"/"===o.asPath&&l&&d&&Date.now()-d<3e3){let e=localStorage.getItem(h);e&&g.has(e)&&"/home"!==e?o.replace(e):o.replace("/home")}},[l,m,d,o]),m)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(i(),{children:[(0,n.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1, viewport-fit=cover"}),(0,n.jsx)("meta",{name:"theme-color",content:"#0D1117"})]}),(0,n.jsx)(t,{...r})]}):(0,n.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh",color:"#888",fontFamily:"sans-serif",background:"#000"},children:"Loadingâ€¦"})}},3434:function(){},9008:function(e,t,r){e.exports=r(3867)},1163:function(e,t,r){e.exports=r(3079)},83:function(e,t,r){"use strict";var n=r(7294),o="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=n.useState,u=n.useEffect,a=n.useLayoutEffect,s=n.useDebugValue;function l(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!o(e,r)}catch(e){return!0}}var c="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var r=t(),n=i({inst:{value:r,getSnapshot:t}}),o=n[0].inst,c=n[1];return a(function(){o.value=r,o.getSnapshot=t,l(o)&&c({inst:o})},[e,r,t]),u(function(){return l(o)&&c({inst:o}),e(function(){l(o)&&c({inst:o})})},[e]),s(r),r};t.useSyncExternalStore=void 0!==n.useSyncExternalStore?n.useSyncExternalStore:c},6251:function(e,t,r){"use strict";var n=r(7294),o=r(1688),i="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},u=o.useSyncExternalStore,a=n.useRef,s=n.useEffect,l=n.useMemo,c=n.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,r,n,o){var f=a(null);if(null===f.current){var d={hasValue:!1,value:null};f.current=d}else d=f.current;var m=u(e,(f=l(function(){function e(e){if(!s){if(s=!0,u=e,e=n(e),void 0!==o&&d.hasValue){var t=d.value;if(o(t,e))return a=t}return a=e}if(t=a,i(u,e))return t;var r=n(e);return void 0!==o&&o(t,r)?(u=e,t):(u=e,a=r)}var u,a,s=!1,l=void 0===r?null:r;return[function(){return e(t())},null===l?void 0:function(){return e(l())}]},[t,r,n,o]))[0],f[1]);return s(function(){d.hasValue=!0,d.value=m},[m]),c(m),m}},1688:function(e,t,r){"use strict";e.exports=r(83)},2798:function(e,t,r){"use strict";e.exports=r(6251)},4529:function(e,t,r){"use strict";r.d(t,{Ue:function(){return d}});let n=e=>{let t;let r=new Set,n=(e,n)=>{let o="function"==typeof e?e(t):e;if(!Object.is(o,t)){let e=t;t=(null!=n?n:"object"!=typeof o||null===o)?o:Object.assign({},t,o),r.forEach(r=>r(t,e))}},o=()=>t,i={setState:n,getState:o,getInitialState:()=>u,subscribe:e=>(r.add(e),()=>r.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},u=t=e(n,o,i);return i},o=e=>e?n(e):n;var i=r(7294),u=r(2798);let{useDebugValue:a}=i,{useSyncExternalStoreWithSelector:s}=u,l=!1,c=e=>e,f=e=>{"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");let t="function"==typeof e?o(e):e,r=(e,r)=>(function(e,t=c,r){r&&!l&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),l=!0);let n=s(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return a(n),n})(t,e,r);return Object.assign(r,t),r},d=e=>e?f(e):f}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[774,179],function(){return t(6840),t(3079)}),_N_E=e.O()}]);